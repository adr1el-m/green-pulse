<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GreenPulse - Eco Innovation Hub</title>
    <!-- Add Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="assets/favicon/eco-hub-180.png">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @keyframes leafFall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 0;
            }

            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0.4;
            }
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }

            100% {
                transform: scale(1);
            }
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0) rotate(0deg);
            }

            50% {
                transform: translateY(-20px) rotate(5deg);
            }
        }

        @keyframes shimmer {
            0% {
                background-position: -100% 0;
            }

            100% {
                background-position: 200% 0;
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: all 0.3s ease;
        }

        body {
            background: linear-gradient(135deg, #e0f2f1 0%, #b2dfdb 100%);
            font-family: 'Segoe UI', Arial, sans-serif;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        .falling-leaves {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .leaf {
            position: fixed;
            color: #4CAF50;
            opacity: 0.4;
            animation: leafFall 15s linear infinite;
        }

        .header {
            padding: .5rem;
            text-align: center;
            position: relative;
            z-index: 2;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        h1 {
            font-size: 4rem;
            color: transparent;
            text-transform: uppercase;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            animation: shimmer 3s linear infinite;
            background: linear-gradient(90deg, #1b5e20, #4CAF50, #1b5e20);
            background-size: 200% auto;
            -webkit-background-clip: text;
            background-clip: text;
        }

        h2 {
            font-size: 1.8rem;
            color: #388e3c;
            margin-bottom: 1.5rem;
            font-weight: 300;
        }

        .panel-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            width: 90vw;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 2;
        }

        /* Update bottom panels class */
        .bottom-panels {
            grid-column: 1 / span 3;
            /* Changed from 2 / span 2 to 1 / span 3 to span full width */
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            width: 66.67%;
            /* Makes it take up roughly 2/3 of the container width */
            margin: 0 auto;
            /* Centers the bottom panels container */
        }

        .panel {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
            transform-style: preserve-3d;
            perspective: 1000px;
            animation: float 6s ease-in-out infinite;
            animation-delay: calc(var(--delay) * 1s);
            text-decoration: none;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        .panel:hover {
            transform: translateY(-10px) rotateX(5deg);
            box-shadow: 0 25px 45px rgba(76, 175, 80, 0.2);
        }

        .panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: translateX(-100%);
            transition: 0.6s;
        }

        .panel:hover::before {
            transform: translateX(100%);
        }

        .panel i {
            font-size: 3rem;
            color: transparent;
            margin-bottom: 1rem;
            transition: transform 0.5s ease;
            background: linear-gradient(45deg, #1b5e20, #4CAF50);
            -webkit-background-clip: text;
            background-clip: text;
        }

        .panel:hover i {
            transform: scale(1.2) translateZ(20px);
        }

        .panel-title {
            color: #1b5e20;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            text-decoration: none;
            background: linear-gradient(90deg, #1b5e20, #4CAF50, #1b5e20);
            background-size: 200% auto;
            -webkit-background-clip: text;
            background-clip: text;
            animation: shimmer 3s linear infinite;
        }

        .panel-description {
            color: #388e3c;
            font-size: 0.9rem;
            margin-top: 1rem;
            text-decoration: none;
        }

        .chatbot-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #388e3c;
            color: white;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .chatbot-btn:hover {
            transform: scale(1.1);
            background-color: #4CAF50;
        }

        .chatbox {
            position: fixed;
            bottom: 100px;
            right: 30px;
            width: 350px;
            height: 500px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: none;
            flex-direction: column;
            z-index: 1000;
            overflow: hidden;
        }

        .chatbox-header {
            background: #388e3c;
            color: white;
            padding: 15px;
            font-size: 1.2rem;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chatbox-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .message {
            max-width: 80%;
            padding: 10px 15px;
            border-radius: 15px;
            margin: 5px 0;
            word-wrap: break-word;
        }

        .user-message {
            background: #E8F5E9;
            color: #1b5e20;
            align-self: flex-end;
        }

        .bot-message {
            background: #F1F1F1;
            color: #333;
            align-self: flex-start;
        }

        .chatbox-input {
            display: flex;
            padding: 15px;
            gap: 10px;
            background: #fff;
            border-top: 1px solid #eee;
        }

        .chatbox-input input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 25px;
            font-size: 1rem;
            outline: none;
        }

        .chatbox-input button {
            background: #388e3c;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
        }

        .chatbox-input button:hover {
            background: #4CAF50;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }

            h2 {
                font-size: 1.2rem;
            }

            .panel-container {
                grid-template-columns: 1fr;
            }

            .bottom-panels {
                grid-column: 1;
                grid-template-columns: 1fr;
                width: 100%;
                /* Full width on mobile */
            }

            .chatbox {
                width: 90vw;
                right: 5vw;
            }
        }

        /* Progress bar styles */
        .eco-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 8px;
            background: rgba(76, 175, 80, 0.1);
            z-index: 1000;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #1b5e20, #4CAF50);
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* Achievement badge */
        .achievement {
            position: fixed;
            bottom: 100px;
            left: 30px;
            background: linear-gradient(45deg, #1b5e20, #4CAF50);
            box-shadow: 0 10px 30px rgba(76, 175, 80, 0.3);
            color: white;
            padding: 15px 25px;
            border-radius: 25px;
            display: none;
            align-items: center;
            gap: 10px;
            animation: slideIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 1000;
            transform-origin: left center;
        }

        @keyframes slideIn {
            from {
                transform: translateX(-100%) scale(0.8);
                opacity: 0;
            }

            to {
                transform: translateX(0) scale(1);
                opacity: 1;
            }
        }

        /* Smooth scroll behavior */
        html {
            scroll-behavior: smooth;
        }

        /* Loading indicator */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #e0f2f1 0%, #b2dfdb 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease-out;
        }

        .loading-spinner {
            width: 100px;
            height: 100px;
            border: 5px solid #4CAF50;
            border-top: 5px solid transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* Quick Actions */
        .quick-actions {
            position: fixed;
            bottom: 30px;
            left: 30px;
            display: flex;
            gap: 15px;
            z-index: 900;
        }

        .action-btn {
            background: rgba(255, 255, 255, 0.9);
            border: none;
            padding: 15px 25px;
            border-radius: 25px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
            color: #1b5e20;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .action-btn:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.3);
        }

        .action-btn i {
            font-size: 1.2em;
            color: #4CAF50;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1100;
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease-out;
        }

        .eco-glass {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            border-radius: 20px;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            min-width: 500px;
            max-width: 800px;
            padding: 0;
            animation: slideUp 0.4s ease-out;
            box-sizing: border-box;
        }

        .modal-header {
            background: linear-gradient(135deg, #1b5e20, #4CAF50);
            color: white;
            padding: 20px;
            border-radius: 20px 20px 0 0;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .modal-header i {
            font-size: 1.5em;
        }

        .calculator-form {
            width: 100%;
            max-width: 100%;
            margin: 0 auto;
            box-sizing: border-box;
            padding: 1rem;
            margin-bottom: 0;
        }

        .calculator-form .form-row {
            display: flex;
            gap: 1rem;
            flex-wrap: nowrap;
            margin-bottom: 20px;
        }

        .calculator-form .input-group {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-sizing: border-box;
        }

        .calculator-form .input-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid rgba(76, 175, 80, 0.2);
            border-radius: 12px;
            font-size: 1rem;
            box-sizing: border-box;
        }

        .calculator-form .input-group input:focus {
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
            outline: none;
        }

        .live-impact {
            background: rgba(76, 175, 80, 0.1);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
        }

        .impact-meter {
            height: 8px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .meter-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #4CAF50, #1b5e20);
            transition: width 0.5s ease;
        }

        .calculate-btn {
            display: block;
            margin: 20px auto 0;
            padding: 12px 25px;
            background: linear-gradient(135deg, #1b5e20, #4CAF50);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
        }

        .calculation-result {
            padding: 20px;
            text-align: center;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                transform: translate(-50%, 20px);
                opacity: 0;
            }

            to {
                transform: translate(-50%, -50%);
                opacity: 1;
            }
        }

        .eco-tip-container h2 {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 40px;
        }

        /* Particle effects */
        .eco-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .particle {
            position: absolute;
            background: rgba(76, 175, 80, 0.2);
            border-radius: 50%;
            animation: float 8s infinite ease-in-out;
        }

        /* Scroll progress indicator */
        .scroll-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: rgba(76, 175, 80, 0.1);
            z-index: 1000;
        }

        .progress-value {
            height: 100%;
            background: linear-gradient(90deg, #1b5e20, #4CAF50);
            width: 0%;
            transition: width 0.2s ease;
        }

        /* Page transitions */
        .page-transition {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #4CAF50;
            transform: scaleY(0);
            transform-origin: top;
            transition: transform 0.5s ease;
            z-index: 9999;
        }

        /* Theme switcher */
        .theme-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .theme-btn {
            background: rgba(255, 255, 255, 0.9);
            border: none;
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        /* Dark theme styles */
        [data-theme="dark"] {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
        }

        [data-theme="dark"] .panel {
            background: rgba(0, 0, 0, 0.2);
        }

        [data-theme="dark"] .panel-title {
            color: #4CAF50;
        }

        [data-theme="dark"] .panel-description {
            color: #a0a0a0;
        }

        /* Add these new dark theme styles for chatbox */
        [data-theme="dark"] .chatbox {
            background: rgba(33, 33, 33, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        [data-theme="dark"] .chatbox-header {
            background: #1b5e20;
        }

        [data-theme="dark"] .user-message {
            background: #2e7d32;
            color: #ffffff;
        }

        [data-theme="dark"] .bot-message {
            background: #424242;
            color: #ffffff;
        }

        [data-theme="dark"] .chatbox-input {
            background: #333333;
            border-top: 1px solid #424242;
        }

        [data-theme="dark"] .chatbox-input input {
            background: #424242;
            border: 1px solid #555555;
            color: #ffffff;
        }

        [data-theme="dark"] .chatbox-input input::placeholder {
            color: #888888;
        }

        /* Dark theme styles for calculator modal */
        [data-theme="dark"] .modal-content {
            background: rgba(33, 33, 33, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        [data-theme="dark"] .modal-header {
            background: linear-gradient(135deg, #1b5e20, #2e7d32);
            color: #ffffff;
        }

        [data-theme="dark"] .input-group input {
            background: #424242;
            border: 2px solid rgba(76, 175, 80, 0.3);
            color: #ffffff;
        }

        [data-theme="dark"] .input-group input:focus {
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2);
        }

        [data-theme="dark"] .input-group input::placeholder {
            color: #888888;
        }

        [data-theme="dark"] .live-impact {
            background: rgba(76, 175, 80, 0.15);
            color: #ffffff;
        }

        [data-theme="dark"] .impact-meter {
            background: rgba(255, 255, 255, 0.1);
        }

        [data-theme="dark"] .calculation-result {
            color: #ffffff;
        }

        [data-theme="dark"] .impact-results {
            color: #ffffff;
        }

        [data-theme="dark"] .eco-tip {
            background: rgba(76, 175, 80, 0.15);
        }

        [data-theme="dark"] .close-modal {
            color: #ffffff;
        }

        /* Updated Eco Tips Carousel Styles */
        .eco-tips-carousel {
            width: 90%;
            max-width: 800px;
            margin: 2rem auto;
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
        }

        .tip-container {
            width: 100%;
            padding: 2rem;
            border-radius: 20px;
            margin: 0 auto;
            position: relative;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(76, 175, 80, 0.2);
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.1);
            height: 200px;
        }

        .tip-container:hover {
            transform: translateY(-5px);
            border-color: #4CAF50;
        }

        .eco-decoration {
            position: absolute;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            opacity: 0.6;
            animation: float 3s ease-in-out infinite;
        }

        .eco-decoration.left {
            left: -30px;
        }

        .eco-decoration.right {
            right: -30px;
        }

        .eco-decoration span {
            font-size: 1.5rem;
            transform: rotate(-10deg);
        }

        .eco-decoration.right span {
            transform: rotate(10deg);
        }

        .tip {
            width: 100%;
            display: flex;
            align-items: center;
            gap: 2rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            position: absolute;
        }

        .tip.active {
            opacity: 1;
            position: relative;
            transform: none;
        }

        .tip-icon-wrapper {
            background: linear-gradient(135deg, #1b5e20, #4CAF50);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .tip i {
            font-size: 1.8rem;
            color: white;
        }

        .tip-content {
            width: 100%;
            text-align: left;
        }

        .tip-content h3 {
            color: #1b5e20;
            margin-bottom: 0.5rem;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .tip p {
            font-size: 1.1rem;
            line-height: 1.6;
            color: #2e7d32;
        }

        .next-tip-btn {
            background: linear-gradient(135deg, #1b5e20, #4CAF50);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .next-tip-btn:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .next-tip-btn.disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }

        .next-tip-btn i {
            font-size: 0.9rem;
            transition: transform 0.3s ease;
        }

        .next-tip-btn:hover i {
            transform: translateX(3px);
        }

        /* Dark theme styles */
        [data-theme="dark"] .tip-container {
            background: rgba(33, 33, 33, 0.95);
            border-color: rgba(76, 175, 80, 0.3);
        }

        [data-theme="dark"] .tip-content h3 {
            color: #4CAF50;
        }

        [data-theme="dark"] .tip p {
            color: #ffffff;
        }

        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .eco-tips-carousel {
                width: 95%;
            }

            .tip-container {
                padding: 1.5rem;
            }

            .tip {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }

            .eco-decoration {
                display: none;
            }

            .tip p {
                font-size: 1rem;
            }

            .next-tip-btn {
                width: 100%;
                justify-content: center;
            }
        }

        /* Loading animation */
        @keyframes pulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1);
            }
        }

        .tip i.loading {
            animation: pulse 1.5s ease-in-out infinite;
        }

        /* Add new loading animation styles */
        @keyframes loadingSpin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        @keyframes loadingPulse {
            0% {
                transform: scale(1);
                opacity: 0.8;
            }

            50% {
                transform: scale(1.2);
                opacity: 1;
            }

            100% {
                transform: scale(1);
                opacity: 0.8;
            }
        }

        .tip.loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1rem;
        }

        .loading-leaf {
            font-size: 2.5rem;
            color: #4CAF50;
            animation: loadingSpin 2s linear infinite, loadingPulse 1.5s ease-in-out infinite;
        }

        .loading-text {
            color: #388e3c;
            font-size: 1rem;
            margin-top: 0.5rem;
        }

        /* Remove old loading dots styles */
        .loading-dots {
            display: none;
        }

        /* Add this CSS to increase the size of the Daily Eco Tip header */
        .tip-content h3 {
            font-size: 2.5rem;
            /* Adjust the size as needed */
            margin-bottom: 1rem;
            /* Add some space below the header */
        }

        /* Update the close button styles for better visibility and interaction */
        .close-modal {
            background: transparent;
            /* Make background transparent */
            border: none;
            /* Remove border */
            color: white;
            /* Change color to white for better contrast */
            font-size: 1.5em;
            /* Increase font size */
            cursor: pointer;
            /* Change cursor to pointer */
            transition: color 0.3s ease;
            /* Add transition for hover effect */
        }

        .close-modal:hover {
            color: #ff4d4d;
            /* Change color on hover for better feedback */
        }

        /* Dark theme styles for quick actions */
        [data-theme="dark"] .quick-actions {
            background: rgba(33, 33, 33, 0.9);
            /* Dark background for quick actions */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            /* Darker shadow for depth */
        }

        [data-theme="dark"] .action-btn {
            background: rgba(255, 255, 255, 0.1);
            /* Lighter background for action buttons in dark mode */
            color: #ffffff;
            /* Change text color to white */
        }

        [data-theme="dark"] .action-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            /* Lighter background on hover */
        }

        /* Dark theme styles for FAQ section */
        [data-theme="dark"] .faq-section {
            background: rgba(33, 33, 33, 0.95);
            /* Dark background for FAQ section */
            color: white;
            /* Change text color to white */
        }

        [data-theme="dark"] .faq-item h3 {
            color: #4CAF50;
            /* Change question color to match the theme */
        }

        [data-theme="dark"] .faq-item p {
            color: #ffffff;
            /* Change answer text color to white */
        }

        /* FAQ Section Styles */
        .faq-section {
            background: rgba(255, 255, 255, 0.9);
            padding: 2rem;
            border-radius: 10px;
            margin: 2rem 0;
            transition: background 0.3s, color 0.3s;
        }

        /* Make the FAQ heading bold */
        .faq-section h2 {
            text-align: center;
            margin-bottom: 1rem;
            color: #1b5e20;
            font-weight: bold;
        }

        /* FAQ Items */
        .faq-item {
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            padding: 1rem 0;
        }

        .faq-question {
            color: #1b5e20;
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0.5rem;
            margin: 0;
            border-radius: 5px;
            transition: background 0.3s, color 0.3s;
        }

        .faq-question:hover {
            background: rgba(76, 175, 80, 0.1);
        }

        .faq-answer {
            color: #1b5e20;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
            transition: max-height 0.4s ease, opacity 0.4s ease;
            padding: 0 0.5rem;
            margin-top: 0.5rem;
        }

        /* When the FAQ answer is toggled open */
        .faq-answer.active {
            max-height: 150px; /* Adjust if needed */
            opacity: 1;
            padding: 0.5rem;
        }

        /* Dark Mode FAQ Styles */
        [data-theme="dark"] .faq-section {
            background: rgba(33, 33, 33, 0.95);
            color: #ffffff;
        }

        [data-theme="dark"] .faq-section h2 {
            color: #ffffff;
        }

        [data-theme="dark"] .faq-question {
            color: #4CAF50;
        }

        [data-theme="dark"] .faq-question:hover {
            background: rgba(76, 175, 80, 0.2);
        }

        [data-theme="dark"] .faq-answer {
            background: rgba(76, 175, 80, 0.2);
            color: #ffffff;
        }

        /* Optional: If you want to explicitly target light mode (assuming data-theme="light") */
        [data-theme="light"] .faq-question,
        [data-theme="light"] .faq-answer {
            color: #1b5e20;
        }

        /* Optional: Adjust font size on smaller screens */
        @media (max-width: 600px) {
            .calculator-form .input-group input {
                font-size: 0.9rem;
            }
        }

        /* Updated Calculator Modal Styles */
        #calculatorModal .modal-content {
            width: 90vw;           /* Adjusted width for a wider modal */
            max-width: 600px;     /* Cap the modal width at 600px */
            max-height: 80vh;     /* Set a maximum height for the modal */
            padding: 1rem;        /* Optional padding for inner content */
            margin: auto;         /* Center the modal horizontally */
            box-sizing: border-box;
            overflow-y: auto;     /* Make the modal scrollable */
        }

        /* Updated Calculator Result Styles */
        .impact-results {
            background: linear-gradient(135deg, #f0fff4, #ccffe6); /* Subtle green gradient */
            border: 1px solid #4CAF50;
            padding: 20px;
            border-radius: 12px;
            color: #1b5e20; /* Default text color */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        }

        /* Dark theme styles for impact results */
        [data-theme="dark"] .impact-results {
            background: rgba(33, 33, 33, 0.95); /* Dark background */
            border: 1px solid rgba(255, 255, 255, 0.3); /* Light border */
            color: #ffffff; /* Change text color to white for better contrast */
        }

        /* Custom Scrollbar Styles for Modal */
        #calculatorModal .modal-content::-webkit-scrollbar {
            width: 8px; /* Width of the scrollbar */
        }

        #calculatorModal .modal-content::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1); /* Background of the scrollbar track */
            border-radius: 10px; /* Rounded corners for the track */
        }

        #calculatorModal .modal-content::-webkit-scrollbar-thumb {
            background: #4CAF50; /* Color of the scrollbar thumb */
            border-radius: 10px; /* Rounded corners for the thumb */
        }

        #calculatorModal .modal-content::-webkit-scrollbar-thumb:hover {
            background: #388e3c; /* Darker color on hover */
        }

        /* For Firefox */
        #calculatorModal .modal-content {
            scrollbar-width: thin; /* Make scrollbar thin */
            scrollbar-color: #4CAF50 rgba(0, 0, 0, 0.1); /* Thumb color and track color */
        }
    </style>
</head>

<body>
    <!-- Add loading overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <div class="falling-leaves" id="leaves"></div>

    <div class="header">
        <h1>GreenPulse</h1>
    </div>

    <!-- Add after header -->
    <div class="theme-switcher">
        <button class="theme-btn" onclick="toggleTheme()">
            <i class="fas fa-moon"></i>
        </button>
    </div>


    <!-- Update the eco-tips-carousel structure -->
    <div class="eco-tips-carousel">
        <div class="tip-container eco-glass">
            <div class="eco-decoration left">
                <span>🌱</span>
                <span>🌿</span>
                <span>🍃</span>
            </div>
            <div class="tip active" id="currentTip">
                <div class="tip-content" style="text-align: center;">
                    <h3 style="margin: 0;">Daily Eco Tip</h3>
                    <p id="tipText">Loading eco tip...</p>
                </div>
            </div>
            <div class="eco-decoration right">
                <span>🌳</span>
                <span>🌸</span>
                <span>🦋</span>
            </div>
        </div>
        <button class="next-tip-btn" onclick="nextTip()" id="nextTipBtn">
            <span class="btn-text">Next Tip</span>
            <i class="fas fa-chevron-right"></i>
        </button>
    </div>

    <div class="panel-container">
        <a href="pages/green-gauge.html" class="panel">
            <i class="fas fa-leaf"></i>
            <div class="panel-title" style="text-decoration: none;">Green Gauge</div>
            <div class="panel-description">Calculates your environmental impact and get personalized recommendations
            </div>
        </a>

        <a href="pages/enviro-sort.html" class="panel">
            <i class="fas fa-microchip"></i>
            <div class="panel-title">Enviro Sort</div>
            <div class="panel-description">AI-powered waste classification tool that helps users sort trash correctly
                using image recognition</div>
        </a>
        <a href="pages/eco-budget.html" class="panel">
            <i class="fas fa-coins"></i>
            <div class="panel-title">Eco Budget</div>
            <div class="panel-description">Plan and track your eco-friendly investments and savings</div>
        </a>
        <div class="bottom-panels">
            <a href="pages/scrap-chef.html" class="panel">
                <i class="fas fa-utensils"></i>
                <div class="panel-title">Scrap Chef</div>
                <div class="panel-description">Turn food waste into delicious meals with AI-powered recipes</div>
            </a>
            <a href="pages/verde-quest.html" class="panel">
                <i class="fas fa-question-circle"></i>
                <div class="panel-title">Verde Quest</div>
                <div class="panel-description">Test your knowledge about environmental sustainability</div>
            </a>
        </div>
    </div>

    <div class="chatbot-btn" onclick="toggleChatbox()">
        <i class="fas fa-comments"></i>
    </div>

    <div class="chatbox" id="chatbox">
        <div class="chatbox-header">
            <i class="fas fa-leaf"></i>
            <span>Chat with EcoBot</span>
            <i class="fas fa-times" onclick="toggleChatbox()"></i>
        </div>
        <div class="chatbox-messages" id="messages"></div>
        <div class="chatbox-input">
            <input type="text" id="userMessage" placeholder="Ask about sustainability..."
                onkeypress="handleKeyPress(event)">
            <button onclick="sendMessage()">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <!-- Add progress bar -->
    <div class="eco-progress">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <!-- Add achievement notification -->
    <div class="achievement" id="achievement">
        <i class="fas fa-award"></i>
        <span id="achievementText"></span>
    </div>

    <!-- Add these elements after the header div -->
    <div class="quick-actions">
        <button class="action-btn pulse-effect" onclick="showModal('calculator')">
            <i class="fas fa-calculator"></i>
            <span>Quick Calculate</span>
            <div class="ripple"></div>
        </button>
    </div>

    <div class="modal" id="calculatorModal">
        <div class="modal-content eco-glass">
            <div class="modal-header">
                <i class="fas fa-leaf"></i>
                <h3>Carbon Footprint Calculator</h3>
                <button class="close-modal" onclick="hideModal('calculator')">×</button>
            </div>

            <div class="calculator-form">
                <!-- Horizontal Row for Input Fields -->
                <div class="form-row">
                    <div class="input-group">
                        <i class="fas fa-bolt"></i>
                        <input type="number" id="electricityUsage" placeholder="Monthly electricity (kWh)" onchange="updateLiveImpact()">
                    </div>
                    <div class="input-group">
                        <i class="fas fa-water"></i>
                        <input type="number" id="waterUsage" placeholder="Monthly water usage (Gallons)" onchange="updateLiveImpact()">
                    </div>
                    <div class="input-group">
                        <i class="fas fa-car"></i>
                        <input type="number" id="transportationUsage" placeholder="Monthly transportation (miles)" onchange="updateLiveImpact()">
                    </div>
                    <div class="input-group">
                        <i class="fas fa-trash"></i>
                        <input type="number" id="wasteUsage" placeholder="Monthly waste (pounds)" onchange="updateLiveImpact()">
                    </div>
                </div>

                <!-- Existing Live Impact Meter -->
                <div class="live-impact" id="liveImpact">
                    <div class="impact-meter">
                        <div class="meter-fill" id="impactMeter"></div>
                    </div>
                    <p>Impact Level: <span id="impactLevel">Low</span></p>
                </div>

                <!-- Impact Visualization Chart -->
                <div class="chart-container" style="position: relative; height:200px; margin-top:20px; width:100%;">
                    <canvas id="impactChart"></canvas>
                </div>

                <button class="calculate-btn" onclick="calculateImpact()">
                    <i class="fas fa-calculator"></i>
                    Calculate Impact
                </button>
            </div>

            <div id="calculationResult" class="calculation-result"></div>
        </div>
    </div>

    <!-- Add these new elements after the header -->
    <div class="eco-particles"></div>

    <div class="scroll-progress">
        <div class="progress-value"></div>
    </div>

    <div class="page-transition"></div>

    <div class="faq-section">
        <h2>Frequently Asked Questions</h2>
        <div class="faq-item">
            <h3 class="faq-question" onclick="toggleFAQ(this)">1. What is GreenPulse?</h3>
            <p class="faq-answer">GreenPulse is an eco-innovation hub that provides tools and resources to help
                individuals and organizations reduce their environmental impact.</p>
        </div>
        <div class="faq-item">
            <h3 class="faq-question" onclick="toggleFAQ(this)">2. How does the carbon footprint calculator work?</h3>
            <p class="faq-answer">The calculator estimates your carbon footprint based on your electricity, water usage,
                transportation, and waste. It provides personalized recommendations to help you reduce your impact.</p>
        </div>
        <div class="faq-item">
            <h3 class="faq-question" onclick="toggleFAQ(this)">3. Why is it important to track my carbon footprint?</h3>
            <p class="faq-answer">Tracking your carbon footprint helps you understand your environmental impact and
                identify areas where you can make changes to live more sustainably.</p>
        </div>
        <div class="faq-item">
            <h3 class="faq-question" onclick="toggleFAQ(this)">4. How can I reduce my carbon footprint?</h3>
            <p class="faq-answer">You can reduce your carbon footprint by using energy-efficient appliances, conserving
                water, reducing waste, and opting for sustainable transportation options.</p>
        </div>
        <div class="faq-item">
            <h3 class="faq-question" onclick="toggleFAQ(this)">5. Can I contribute to GreenPulse?</h3>
            <p class="faq-answer">Yes! You can contribute by sharing your eco-friendly tips, participating in community
                discussions, and spreading the word about sustainability.</p>
        </div>
    </div>

    <script>
        // Create falling leaves effect
        function createLeaves() {
            const leaves = document.getElementById('leaves');
            const leafIcons = ['🍃', '🌿', '☘️'];
            const numberOfLeaves = 15;

            for (let i = 0; i < numberOfLeaves; i++) {
                const leaf = document.createElement('div');
                leaf.className = 'leaf';
                leaf.textContent = leafIcons[Math.floor(Math.random() * leafIcons.length)];
                leaf.style.left = `${Math.random() * 100}vw`;
                leaf.style.animationDuration = `${15 + Math.random() * 10}s`;
                leaf.style.animationDelay = `${-Math.random() * 15}s`;
                leaf.style.fontSize = `${20 + Math.random() * 10}px`;
                leaves.appendChild(leaf);
            }
        }

        createLeaves();

        // Chat functionality
        function toggleChatbox() {
            const chatbox = document.getElementById('chatbox');
            chatbox.style.display = chatbox.style.display === 'none' || chatbox.style.display === '' ? 'flex' : 'none';
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        async function sendMessage() {
            const input = document.getElementById('userMessage');
            const message = input.value.trim();
            if (!message) return;

            const messages = document.getElementById('messages');

            // Add user message
            const userDiv = document.createElement('div');
            userDiv.className = 'message user-message';
            userDiv.innerHTML = message;
            messages.appendChild(userDiv);

            input.value = '';
            messages.scrollTop = messages.scrollHeight;

            // Simulate typing indicator
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message bot-message';
            typingDiv.innerHTML = '...';
            messages.appendChild(typingDiv);
            messages.scrollTop = messages.scrollHeight;

            // Get and display bot response
            const response = await getChatbotResponse(message);
            typingDiv.innerHTML = response;
            messages.scrollTop = messages.scrollHeight;
        }

        async function getChatbotResponse(message) {
            const apiKey = 'AIzaSyDr-mS0aSHgcapEfJ5oNSaoiD4jyLqUZNA';
            const url = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent';

            try {
                const response = await fetch(`${url}?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: message
                            }]
                        }]
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();

                if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                    return data.candidates[0].content.parts[0].text;
                } else {
                    console.error("Unexpected API response structure:", data);
                    return "I apologize, but I'm having trouble processing your request right now.";
                }
            } catch (error) {
                console.error("Error in getChatbotResponse:", error);
                throw error;
            }
        }

        // Progress tracking
        let progress = 0;
        const panels = document.querySelectorAll('.panel');
        panels.forEach(panel => {
            panel.addEventListener('click', () => {
                progress += 20;
                if (progress > 100) progress = 100;
                document.getElementById('progressBar').style.width = `${progress}%`;

                if (progress === 100) {
                    showAchievement('Eco Master! 🌟 You\'ve explored all features!');
                }
            });
        });

        // Initialize panels with staggered animation
        document.querySelectorAll('.panel').forEach((panel, index) => {
            panel.style.setProperty('--delay', index * 0.2);
            panel.style.opacity = '0';
            panel.style.transform = 'translateY(50px)';
        });

        // Loading and animation sequence
        window.addEventListener('load', () => {
            setTimeout(() => {
                document.getElementById('loadingOverlay').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('loadingOverlay').style.display = 'none';

                    // Animate panels
                    document.querySelectorAll('.panel').forEach((panel, index) => {
                        setTimeout(() => {
                            panel.style.opacity = '1';
                            panel.style.transform = 'translateY(0)';
                        }, index * 200);
                    });
                }, 500);
            }, 1000);
            createEcoParticles();
        });

        // Enhanced progress tracking with smooth animation
        function updateProgress(value) {
            const progressBar = document.getElementById('progressBar');
            progressBar.style.transition = 'width 0.8s cubic-bezier(0.4, 0, 0.2, 1)';
            progressBar.style.width = `${value}%`;
        }

        // Enhanced achievement notification
        function showAchievement(text) {
            const achievement = document.getElementById('achievement');
            const achievementText = document.getElementById('achievementText');
            achievementText.textContent = text;
            achievement.style.display = 'flex';
            achievement.style.animation = 'slideIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55)';

            // Add confetti effect
            createConfetti();

            setTimeout(() => {
                achievement.style.animation = 'slideIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55) reverse';
                setTimeout(() => {
                    achievement.style.display = 'none';
                }, 500);
            }, 3000);
        }

        // Simple confetti effect
        function createConfetti() {
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.style.cssText = `
                    position: fixed;
                    width: 10px;
                    height: 10px;
                    background: ${['#4CAF50', '#1b5e20', '#81C784'][Math.floor(Math.random() * 3)]};
                    left: ${Math.random() * 100}vw;
                    top: -10px;
                    transform: rotate(${Math.random() * 360}deg);
                    pointer-events: none;
                `;
                document.body.appendChild(confetti);

                const animation = confetti.animate([
                    { transform: `translate(0, 0) rotate(0deg)` },
                    { transform: `translate(${Math.random() * 200 - 100}px, ${window.innerHeight}px) rotate(${Math.random() * 360}deg)` }
                ], {
                    duration: 2000 + Math.random() * 1000,
                    easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
                });

                animation.onfinish = () => confetti.remove();
            }
        }

        // Enhanced falling leaves with mouse interaction
        document.addEventListener('mousemove', (e) => {
            const leaves = document.querySelectorAll('.leaf');
            leaves.forEach(leaf => {
                const rect = leaf.getBoundingClientRect();
                const distance = Math.hypot(
                    e.clientX - (rect.left + rect.width / 2),
                    e.clientY - (rect.top + rect.height / 2)
                );

                if (distance < 100) {
                    const angle = Math.atan2(
                        e.clientY - (rect.top + rect.height / 2),
                        e.clientX - (rect.left + rect.width / 2)
                    );
                    leaf.style.transform += ` translate(${Math.cos(angle) * 20}px, ${Math.sin(angle) * 20}px)`;
                }
            });
        });

        // Modal Functions
        function showModal(type) {
            document.getElementById(`${type}Modal`).style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function hideModal(type) {
            document.getElementById(`${type}Modal`).style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        function updateLiveImpact() {
            const electricity = parseFloat(document.getElementById('electricityUsage').value) || 0;
            const water = parseFloat(document.getElementById('waterUsage').value) || 0;
            const transportation = parseFloat(document.getElementById('transportationUsage').value) || 0;
            const waste = parseFloat(document.getElementById('wasteUsage').value) || 0;

            // Calculate individual impacts
            const electricityImpact = electricity * 0.92;
            const waterImpact = water * 0.18;
            const transportationImpact = transportation * 0.411;
            const wasteImpact = waste * 0.1;
            const totalImpact = electricityImpact + waterImpact + transportationImpact + wasteImpact;

            // Update the impact meter (scaling totalImpact to a 0%-100% width)
            const percentage = Math.min((totalImpact / 1000) * 100, 100);
            document.getElementById('impactMeter').style.width = `${percentage}%`;

            // Determine impact level based on totalImpact value
            let level = 'Low';
            if (totalImpact > 500) level = 'High';
            else if (totalImpact > 200) level = 'Medium';
            document.getElementById('impactLevel').textContent = level;

            // Update the Chart.js data if available
            if (window.impactChart) {
                window.impactChart.data.datasets[0].data = [electricityImpact, waterImpact, transportationImpact, wasteImpact];
                // Optionally, adjust the Y-axis maximum if totalImpact is high
                window.impactChart.options.scales.y.suggestedMax = Math.max(totalImpact, 100);
                window.impactChart.update();
            }
        }

        function calculateImpact() {
            const electricity = document.getElementById('electricityUsage').value;
            const water = document.getElementById('waterUsage').value;
            const transportation = document.getElementById('transportationUsage').value;
            const waste = document.getElementById('wasteUsage').value;

            if (!electricity || !water || !transportation || !waste) {
                document.getElementById('calculationResult').innerHTML = `
                    <div class="error-message">
                        <i class="fas fa-exclamation-circle"></i>
                        <p>Please fill in all fields to calculate your impact.</p>
                    </div>
                `;
                return;
            }

            // Calculate carbon footprint
            const carbonFootprint = (electricity * 0.92 + water * 0.18 + transportation * 0.411 + waste * 0.1).toFixed(2);
            const treesNeeded = (carbonFootprint / 48).toFixed(1);

            document.getElementById('calculationResult').innerHTML = `
                <div class="impact-results">
                    <h4>Your Monthly Impact</h4>
                    <div class="result-value">
                        <span>${carbonFootprint}</span>
                        <small>kg CO₂</small>
                    </div>
                    <p>This is equivalent to ${treesNeeded} trees needed to offset your carbon footprint</p>
                </div>
            `;

            // Trigger confetti if impact is low
            if (carbonFootprint < 100) {
                createConfetti();
            }
        }

        // Add these functions to the existing script tag
        function createEcoParticles() {
            const container = document.querySelector('.eco-particles');
            const particleCount = 20;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.width = `${Math.random() * 20 + 10}px`;
                particle.style.height = particle.style.width;
                particle.style.left = `${Math.random() * 100}vw`;
                particle.style.top = `${Math.random() * 100}vh`;
                particle.style.animationDelay = `${Math.random() * 5}s`;
                container.appendChild(particle);
            }
        }

        // Scroll progress indicator
        window.addEventListener('scroll', () => {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.querySelector('.progress-value').style.width = scrolled + '%';
        });

        // Page transition effect
        document.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', (e) => {
                if (link.getAttribute('href').startsWith('#')) return;

                e.preventDefault();
                const transition = document.querySelector('.page-transition');
                transition.style.transform = 'scaleY(1)';

                setTimeout(() => {
                    window.location = link.href;
                }, 500);
            });
        });

        // Intersection Observer for fade-in animations
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, { threshold: 0.1 });

        document.querySelectorAll('.panel').forEach(panel => {
            observer.observe(panel);
        });

        // Theme switcher
        function toggleTheme() {
            const body = document.body;
            const currentTheme = localStorage.getItem('theme') || 'light';
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

            // Save theme preference to localStorage
            localStorage.setItem('theme', newTheme);

            // Apply theme
            body.setAttribute('data-theme', newTheme);

            const themeIcon = document.querySelector('.theme-btn i');
            themeIcon.className = newTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
        }

        // Add theme initialization on page load
        document.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.body.setAttribute('data-theme', savedTheme);
                const themeIcon = document.querySelector('.theme-btn i');
                themeIcon.className = savedTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
            }
        });

        // Update the Eco Tips Carousel functionality
        let currentTipIndex = 0;
        let ecoTips = [];
        let isLoading = false;

        async function fetchEcoTip() {
            try {
                const API_KEY = "YOUR_VALID_API_KEY"; // Replace with your actual API key
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/text-bison-001:generateContent?key=${API_KEY}`, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `Generate a unique, practical eco-friendly tip for sustainable living.
                                    
                                    Requirements:
                                    1. Keep it under 150 characters
                                    2. Make it specific and actionable
                                    3. Focus on daily habits and environmental impact
                                    4. Don't include any prefixes or labels
                                    5. Don't mention "tip" or "eco tip" in the response
                                    6. Make it engaging and motivational
                                    
                                    Format: Just the tip text, no additional context or labels.`
                            }]
                        }]
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                console.log('API Response:', data); // Debug log

                if (!data.candidates || !data.candidates[0] || !data.candidates[0].content) {
                    throw new Error('Invalid API response format');
                }

                const tip = data.candidates[0].content.parts[0].text.trim();
                console.log('Generated tip:', tip); // Debug log
                return tip;

            } catch (error) {
                console.error('Error in fetchEcoTip:', error);
                // If API fails, use fallback tips but don't reuse them
                const fallbackTips = [
                    "Save energy by unplugging devices when not in use - they still consume power even when turned off!",
                    "Use a reusable water bottle instead of plastic bottles to reduce plastic waste and save money.",
                    "Start composting kitchen scraps to reduce waste and create nutrient-rich soil for your garden.",
                    "Switch to LED bulbs - they use 75% less energy and last 25 times longer than incandescent bulbs.",
                    "Take shorter showers to conserve water - even reducing shower time by 2 minutes saves 10 gallons!",
                    "Bring your own reusable bags when shopping to reduce plastic waste.",
                    "Plant herbs in your windowsill for fresh cooking ingredients with zero food miles.",
                    "Use cold water for laundry when possible - it saves energy and is gentler on clothes.",
                    "Start a small balcony garden to grow your own vegetables and reduce carbon footprint.",
                    "Replace paper towels with reusable cloth napkins to reduce paper waste."
                ];

                // Remove used tips from the array to avoid repetition
                const unusedTips = fallbackTips.filter(tip => !ecoTips.includes(tip));
                if (unusedTips.length === 0) return fallbackTips[0]; // If all used, start over
                return unusedTips[Math.floor(Math.random() * unusedTips.length)];
            }
        }

        async function loadMoreTips() {
            // Show loading state before fetching
            const currentTip = document.querySelector('.tip');
            const tipText = document.getElementById('tipText');

            currentTip.classList.add('loading');
            tipText.innerHTML = `
                <div class="loading-leaf">🌿</div>
                <div class="loading-text">Generating eco tip...</div>
            `;

            try {
                // Load tips one at a time to prevent rate limiting
                const newTip = await fetchEcoTip();
                ecoTips.push(newTip);
                console.log('New tip loaded:', newTip);
            } catch (error) {
                console.error('Error loading more tips:', error);
            } finally {
                // Remove loading state
                currentTip.classList.remove('loading');
            }
        }

        function setLoading(loading) {
            isLoading = loading;
            const nextBtn = document.getElementById('nextTipBtn');
            const currentTip = document.querySelector('.tip');
            const tipText = document.getElementById('tipText');

            if (loading) {
                currentTip.classList.add('loading');
                nextBtn.classList.add('disabled');
                nextBtn.disabled = true;
                tipText.innerHTML = `
                    <div class="loading-leaf">🌿</div>
                    <div class="loading-text">Generating eco tip...</div>
                `;
            } else {
                currentTip.classList.remove('loading');
                nextBtn.classList.remove('disabled');
                nextBtn.disabled = false;
            }
        }

        async function displayCurrentTip() {
            if (isLoading) return;

            const tipText = document.getElementById('tipText');
            const currentTip = document.querySelector('.tip');

            // Keep the current tip visible and just update the text
            if (currentTipIndex >= ecoTips.length - 2) {
                await loadMoreTips();
            }

            tipText.textContent = ecoTips[currentTipIndex];
            console.log('Displaying tip:', ecoTips[currentTipIndex]); // Debug log
        }

        async function nextTip() {
            if (isLoading) return;

            if (currentTipIndex >= ecoTips.length - 1) {
                await loadMoreTips();
            }

            currentTipIndex = (currentTipIndex + 1) % Math.max(ecoTips.length, 1);
            await displayCurrentTip();
        }

        // Initialize tips on page load
        window.addEventListener('DOMContentLoaded', async () => {
            await loadMoreTips();
            await displayCurrentTip();

            // Auto-rotate tips every 15 seconds
            setInterval(async () => {
                if (!isLoading) {
                    await nextTip();
                }
            }, 15000);
        });

        function toggleFAQ(element) {
            const answer = element.nextElementSibling;
            answer.classList.toggle('active');
        }

        document.addEventListener('DOMContentLoaded', () => {
            const ctx = document.getElementById('impactChart').getContext('2d');
            window.impactChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Electricity', 'Water', 'Transportation', 'Waste'],
                    datasets: [{
                        label: 'CO₂ Impact (kg)',
                        data: [0, 0, 0, 0],
                        backgroundColor: [
                            'rgba(76, 175, 80, 0.7)',
                            'rgba(139, 195, 74, 0.7)',
                            'rgba(156, 204, 101, 0.7)',
                            'rgba(205, 220, 57, 0.7)'
                        ],
                        borderColor: [
                            'rgba(76, 175, 80, 1)',
                            'rgba(139, 195, 74, 1)',
                            'rgba(156, 204, 101, 1)',
                            'rgba(205, 220, 57, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            suggestedMax: 100
                        }
                    }
                }
            });
        });
    </script>
</body>

</html>